<script>
    function setJustification(){
        $("#justification").attr('value', $("#input_justification").val())
        $("#justifyModal").hide()
        $(".reveal-overlay").hide()
        $("#entryIndicatorsForm").submit()
    }

    function openJustification() {
        $("#myModal").hide()
        $("#justifyModal").show()
    }

    function openIncomplete() {
        $("#entryIncompleteModal").show()
    }

    function closeModal() {
        $("#myModal").hide()
        $(".reveal-overlay").hide()
    }

    function closeJustification() {
        $("#myModal").hide()
        $(".reveal-overlay").hide()
    }
</script>

<div class="reveal-overlay" style="display:inline" >
  <div id="myModal" class="large reveal warning callout" data-open="myModal" aria-labelledby="modalTitle"
       aria-hidden="true"  role="dialog" style="display: block; opacity: 1; top: 194px;">
    <% if !@groups_excedeed.empty? %>
        <h2 id="modalTitle"><%= t("entry_indicators.form.error.title.groups_excedeed")%> </h2>
        <p class="lead"><%= t("entry_indicators.form.error.p1.groups_excedeed")%>
          <strong><%= @groups_excedeed %></strong></p>
        <% unless has_justification?(@unit.id, @period.id) %>
            <p><%= t("entry_indicators.form.error.p2.groups_excedeed_html")%></p>
            <p><%= t("entry_indicators.form.error.p3.groups_excedeed_html")%></p>
            <a class="hollow button" onclick="openJustification()"> <%= t("entry_indicators.form.update.button") %></a>
        <% else %>
            <button class="hollow button" onclick="closeModal()" aria-label="Close modal" type="button">
              <span aria-hidden="true"><%= t("entry_indicators.form.close.button") %></span>
            </button>
        <% end %>
    <% elsif @entry_incomplete %>
        <h2 id="modalTitle"><%= t("entry_indicators.form.error.title.entry_incomplete") %></h2>
        <p> <%= t("entry_indicators.form.error.p1.entry_incomplete") %> </p>
        <button class="hollow button" onclick="closeModal()" aria-label="Close modal" type="button">
          <span aria-hidden="true"><%= t("entry_indicators.form.close.button") %></span>
        </button>
    <% elsif !@entry_without_staff.empty? %>
        <h2 id="modalTile"><%= t("entry_indicators.form.error.title.entry_without_staff") %></h2>
        <p> <%= t("entry_indicators.form.error.p1.entry_without_staff", indicator: entry_staff_error) %></p>
        <button class="hollow button" onclick="closeModal()" aria-label="Close modal" type="button">
          <span aria-hidden="true"><%= t("entry_indicators.form.close.button") %></span>
        </button>
  <% elsif !@errors_in_out_stock.empty? %>
        <h2 id="modalTile"><%= t("entry_indicators.form.error.title.errors_in_out_stock") %></h2>
        <p> <%= t("entry_indicators.form.error.p1.errors_in_out_stock", sub_process: in_out_error) %></p>
        <button class="hollow button" onclick="closeModal()" aria-label="Close modal" type="button">
        <span aria-hidden="true"><%= t("entry_indicators.form.close.button") %></span>
        </button>
    <% end %>
    <button class="close-button" onclick="closeModal()" aria-label="Close modal" type="button">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="secondary callout reveal" id="justifyModal" >
    <h2><%= t("entry_indicators.form.update.justification.title") %></h2>
    <button class="close-button" onclick="closeJustification()" aria-label="Close reveal" type="button">
      <span aria-hidden="true">&times;</span>
    </button>

    <form name="justificationForm">
        <textarea name="input_justification" id="input_justification" placeholder="<%= t("entry_indicators.form.update.justification.label") %>" rows="4" >
          <%=  justification_text(@unit.id, @period.id) %>
        </textarea>
      <a class="hollow button" onclick="setJustification()"><%= t("entry_indicators.form.update.button") %></a>
    </form>
  </div>
</div>